アリスソフトコンバータ集について

概要
このソフトウェア群はアリスソフトの旧作(System3時代まで)のデータを変換するための物です。
標準的だった.DAT形式のアーカイブファイルからデータを切り出し、変換する機能があります。
一部ソフトは前身のチャンピオンソフトのデータでも動作しました。

警告
動作無保証です。これらのツールを利用する前に元データのバックアップを取ることを強く要求します。
このソフトウェア群は作者が自分の用を足すために作成した物であり、エラーチェックなどは不完全です。
一部のコードはライブラリのサンプルなどからコピペしただけの部分が有ります(関数の意味ぐらいはチェックしてますが)。
よって作者の環境に依存する部分が有るかも知れません。
ソースコードは公開されています。気になる方はソースを参照して自分で修正、コンパイルするか、利用しないでください。

このソフトウェア群は年齢制限のある市販ソフトウェアに対して動作します。
なお、該当するソフトウェアの最新版の販売から20年経過していることを確認しています。
該当するソフトウェアの殆どが現在配布フリー宣言の下、著作権を維持した一定条件下での無償配布が認められています。
これらの事から、このソフトウェア群により生成された全てのデータの再配布を禁止します。個人で楽しむためだけに利用してください。


作者
kitohまたはlutepatiousのハンドルで活動していました。
https://github.com/Lutepatious/
に公開できるソースが上げられています。

連絡先(メールアドレス)
lutepatious@me.com
なお、不審なメールは勝手にフィルタされます。

利用した処理系、ライブラリ
Visual Studio 2019
libpng
zlib (libpngに必要)

制作動機
x64時代になりDOS時代のソフトを動かしにくくなった。
長いファイル名に慣れすぎてDOS時代の流儀は嫌になった。
そろそろ歳なので今までの整理に入った.

内容物
DATSplitter.exe		アリスソフトの.DAT形式アーカイブからファイルを切り出す。
PC98PCMtoWave.exe	PC-9801版闘神都市IIとAliceの館3のAMUS.DATの後半やAMSE.DATに収録された4bitPCMデータをMicrosoft WAVE形式に変換
TownsPCMtoWave.exe	FM TOWNS版闘神都市IIとAliceの館3のAMUS.TWの後半やASND.DAT、館CDや館CDIIに含まれるFM TOWNS標準SND形式8bitPCMデータをMicrosoft WAVE形式に変換
WaveCorrector.exe	Only You 世紀末のジュリエット達のAWAV.DATに含まれるMicrosoft WAVE形式のファイルを補正。
VSPtoPNG.exe		GL3,VSP,VSP256色,VSP200line,GM3,PC88の各形式のファイルをPNGに変換。
MSXtoPNG.exeシリーズ	MSX2版のCGファイルをPNGに変換。


基本的な動作
原則としてファイル内容を全てメモリに読み込んでから処理を行います。
その為、対象ファイルの2-4倍程度の空きメモリが必須です。

詳細
DATSplitter.exe

コマンドラインで
path>DATSplitter DAT形式ファイル
とすると含まれるファイルを
リンク番号(3桁)+ドライブ名(DAT形式ファイルの先頭一文字)+DATファイル内の順番(3桁)+.DAT
の(7文字).DATを(DATファイル名の先頭以外文字列)のディレクトリに切り出します。
アリスソフトアーカイブスの88版Ranceから取り出したDATファイルにも有効でした。
wsetargv.objをリンクしてあるのでワイルドカードが使えます。ファイル複数指定可。

PC98PCMtoWave.exe

コマンドラインで
path>PC98PCMtoWave ファイル
とすると4bitPCMデータをMicrosoft WAVE形式に変換します。
一応末尾チェックはしています。
wsetargv.objをリンクしてあるのでワイルドカードが使えます。ファイル複数指定可。

TownsPCMtoWave.exe

コマンドラインで
path>TownsPCMtoWave ファイル
とするとFM TOWNS標準SND形式8bitPCMデータをMicrosoft WAVE形式に変換します。
一応末尾チェックはしています。
wsetargv.objをリンクしてあるのでワイルドカードが使えます。ファイル複数指定可。

WaveCorrector.exe

コマンドラインで
path>WaveCorrector ファイル
とするとヘッダをチェックし、それに合わせてファイルを修正します。
元のファイルに上書きするのでバックアップは必須です。
アーカイブファイルから切り出した際に末尾につくゴミの除去や、過去のツールのヘッダの誤りを補正するための物です。
wsetargv.objをリンクしてあるのでワイルドカードが使えます。ファイル複数指定可。

VSPtoPNG.exe

コマンドラインで
path>VSPtoPNG ファイル
とするとファイルの先頭をチェックし、ファイル形式を自動判定した上でグラフィックスファイルをPNG形式に変換します。
現在の所、
GL3 初期のアリスソフトのファイル形式でRanceからALICEの館CD迄のPC-9801/FM TOWNSと多数のX68000版
GM3 GL3の亜種でALICEの館CDに含まれるIntruder専用の形式
VSP Rance III以降のPC-9801/FM TOWNS/X68000版の多くで使われた形式
VSP200line PC-8801版Rance IIとアリスネット配布PC-9801 MS-DOS対応版Little Vampireで使われた形式
VSP256色 Super D.P.S以降の256色対応ゲームで使われた形式
PC-8801版 PC-8801版のRance II以外で使われた形式
を自動判定して変換します。
wsetargv.objをリンクしてあるのでワイルドカードが使えます。ファイル複数指定可。

なお一部のX68000版(Rance II,闘神都市など)はファイルフォーマットが判らないので未対応です。

大まかな形式の目安は
Rance、Intruder、クレセントムーンがぁる、あぶない天狗伝説、D.P.S、アリスの館、Rance II、D.P.S SG、闘神都市、アリスの館CDはGL3かその派生
Rance II PC88版とアリスネット配布PC-9801 MS-DOS対応版Little VampireはVSP 200line
Rance III以降の16色版はVSP
Super D.P.S以降の256色対応ゲームのうち、256色の物に限りVSP256

です。

ファイルヘッダから画像のロード位置に合わせて画像を展開し、元データのない個所は透過処理としています。
透過色の判別方法が不明なので不完全です。

FM TOWNS版IntruderのGM3にはパレット情報がありません。その為Ryu1氏作成の移植キットのGM3.COMに含まれるパレット情報を使用しています。
PC-9801版Rance IVの一部画像にはパレット情報がありません(おそらく直前に使う画像のパレットを利用するらしい)。
FM TOWNS版の同じ画像にはパレット情報があるのでそちらを利用する手があります。
表示中にパレットをいじるタイプの画像もあります。単色で何も出ないと思う前に画像編集ソフトでパレットをいじってみましょう。


MSXtoPNG.exe
大まかに言ってVSPtoPNG.exeのMSX2版用です。
個別のタイトル名がついているものはそのタイトル専用です

MSXtoPNG_Intruder.exeのみパレット情報ファイルが必要です。
AディスクのCOLPALET.DATを32バイトずつに分割し、最初のファイルを000として順番に001.pal,002.palとし
DATSplitterから切り出した001????.DAT,002????.DATと拡張子以外のファイル名を一致させればパレット情報ファイルが出来上がります。

MSXtoPNG_GS.exeとMSXtoPNG_GS_TITLE.exeは学園戦記向けの開発中のものです。
MSXtoPNG_GS_TITLE.exeでタイトル画面のCGとパレット情報ファイルが切り出されます。
MSXtoPNG_GS.exeはこのパレット情報を使って動作します。
作中でのパレットの扱いがよくわかっていないので詰まっています。

MSXCombinePNG.exe
MSX版DPS SGの連番ファイル(奇数-偶数順)を合成し、インターレースモードでのCGを再現します。


鬼畜王ランスなどSystem 3.5以降のゲームに対応する気はありません。
ファイルフォーマットがわかりませんし、既存のツールが動かないわけでもないので。
